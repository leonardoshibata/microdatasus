<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="microdatasus">
<title>Perguntas frequentes • microdatasus</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.11/clipboard.min.js" integrity="sha512-7O5pXpc0oCRrxk8RUfDYFgn0nO1t+jLuIOQdOMRp4APB7uZ4vSjspzp5y6YDtDs4VzUSTbWzBFZ/LKJhnyFOKw==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Perguntas frequentes">
<meta property="og:description" content="microdatasus">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--><!-- Global site tag (gtag.js) - Google Analytics --><script async src="https://www.googletagmanager.com/gtag/js?id=G-2M7VLSRDCB"></script><script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-2M7VLSRDCB');
</script>
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light" data-bs-theme="light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">microdatasus</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">2.3.1</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="active nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/exemplos.html">Exemplos de uso</a>
    <a class="dropdown-item" href="../articles/FAQ.html">Perguntas frequentes</a>
  </div>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">Changelog</a>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav">
<li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/rfsaldanha/microdatasus/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>

    
  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>Perguntas frequentes</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/rfsaldanha/microdatasus/blob/HEAD/vignettes/articles/FAQ.Rmd" class="external-link"><code>vignettes/articles/FAQ.Rmd</code></a></small>
      <div class="d-none name"><code>FAQ.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="data-e-local-de-processamento-e-data-e-local-de-ocorrência-do-evento">Data e local de processamento e data e local de ocorrência do
evento<a class="anchor" aria-label="anchor" href="#data-e-local-de-processamento-e-data-e-local-de-ocorr%C3%AAncia-do-evento"></a>
</h2>
<p>Os arquivos disponibilizados pelo DataSUS são organizados segundo
data e local de processamento. Assim, ao se consultar por exemplo, os
dados do SIM para 2020 no RJ, são obtidos os dados dos óbitos que foram
processados no estado do Rio de Janeiro no ano de 2020.</p>
<p>O local e data de processamento pode ser diferente do local e data de
ocorrência do evento. Por exemplo, um óbito ocorrido em Dezembro de 2019
pode ser processado pelas Secretariais de Saúde e pelo DataSUS apenas no
mês seguinte, indo para o arquivo de Janeiro de 2020.</p>
<p>Desta forma, para garantir que você tem os dados de todos em eventos
ocorridos em um ano e/ou mês específico, recomenda-se baixar os dados
aos anos e mêses vizinhos, filtrando posteriormente os registros pela
data de ocorrência desejada.</p>
<p>Exemplo: Para se computador os óbitos ocorridos no Acre em 2020,
recomenda-se baixar os dados de 2019, 2020 e 2021.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/rfsaldanha/microdatasus" class="external-link">microdatasus</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org" class="external-link">dplyr</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://lubridate.tidyverse.org" class="external-link">lubridate</a></span><span class="op">)</span></span>
<span></span>
<span><span class="va">sim_raw</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/fetch_datasus.html">fetch_datasus</a></span><span class="op">(</span></span>
<span>  year_start <span class="op">=</span> <span class="fl">2019</span>, year_end <span class="op">=</span> <span class="fl">2021</span>, </span>
<span>  uf <span class="op">=</span> <span class="st">"AC"</span>, </span>
<span>  information_system <span class="op">=</span> <span class="st">"SIM-DO"</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">sim_p</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/process_sim.html">process_sim</a></span><span class="op">(</span><span class="va">sim_raw</span><span class="op">)</span></span>
<span></span>
<span><span class="va">sim_f</span> <span class="op">&lt;-</span> <span class="va">sim_p</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="fu"><a href="https://lubridate.tidyverse.org/reference/year.html" class="external-link">year</a></span><span class="op">(</span><span class="va">DTOBITO</span><span class="op">)</span> <span class="op">==</span> <span class="fl">2020</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="download-timeout">Download timeout<a class="anchor" aria-label="anchor" href="#download-timeout"></a>
</h2>
<p>Por padrão, o R espera que um arquivo seja baixado em até 60
segundos. Ao baixar algum arquivo muito grande ou com uma conexão com a
Internet lenta, o tempo necessário para download será maior. Neste caso,
você verá uma mensagem de <em>warning</em> semelhante a esta:</p>
<pre><code>1: In utils::download.file(file, temp, mode = "wb", method = "libcurl") :
  downloaded length 12260742 != reported length 30474112
2: In utils::download.file(file, temp, mode = "wb", method = "libcurl") :
  URL 'ftp://ftp.datasus.gov.br/dissemin/publicos/SINAN/DADOS/FINAIS/DENGBR10.dbc': Timeout of 60 seconds was reached</code></pre>
<p>Para corrigir isto, é bem simples: aumente o tempo de tolerância do R
para downloads. Exemplo: tolerância de 2 minutos.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/options.html" class="external-link">options</a></span><span class="op">(</span>timeout <span class="op">=</span> <span class="fl">120</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="download-de-muitos-dados">Download de muitos dados<a class="anchor" aria-label="anchor" href="#download-de-muitos-dados"></a>
</h2>
<p>O download dos dados através do pacote é realizado em memória. Isto
significa que cada arquivo baixado do DataSUS é lido e armazenado na
memória RAM do computador. Caso você esteja baixando muitos arquivos,
para vários estados e anos, você irá precisar de mais memória RAM
disponível.</p>
<p>Um modo de contornar este problema é a realizar o download e
armazenar os resultados em um banco de dados, como SQLite, DuckDB ou
outro. Abaixo segue um exemplo de como fazer isso.</p>
<div class="section level3">
<h3 id="pacotes">Pacotes<a class="anchor" aria-label="anchor" href="#pacotes"></a>
</h3>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/rfsaldanha/microdatasus" class="external-link">microdatasus</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://tidyverse.tidyverse.org" class="external-link">tidyverse</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://dbplyr.tidyverse.org/" class="external-link">dbplyr</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://dbi.r-dbi.org" class="external-link">DBI</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://rsqlite.r-dbi.org" class="external-link">RSQLite</a></span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="cria-conexão-com-o-banco-de-dados">Cria conexão com o banco de dados<a class="anchor" aria-label="anchor" href="#cria-conex%C3%A3o-com-o-banco-de-dados"></a>
</h3>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">conn</span> <span class="op">&lt;-</span> <span class="fu">dbConnect</span><span class="op">(</span><span class="fu">RSQLite</span><span class="fu">::</span><span class="fu">SQLite</span><span class="op">(</span><span class="op">)</span>, <span class="st">"sih.SQLite"</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="realiza-download-e-pré-processamento-dos-dados-em-loop">Realiza download e pré-processamento dos dados em loop<a class="anchor" aria-label="anchor" href="#realiza-download-e-pr%C3%A9-processamento-dos-dados-em-loop"></a>
</h3>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">anos</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2019</span>, <span class="fl">2020</span><span class="op">)</span></span>
<span><span class="va">meses</span> <span class="op">&lt;-</span> <span class="fl">1</span><span class="op">:</span><span class="fl">12</span></span>
<span><span class="va">ufs</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"AC"</span>, <span class="st">"AL"</span>, <span class="st">"AP"</span>, <span class="st">"AM"</span>, <span class="st">"BA"</span>, <span class="st">"CE"</span>, <span class="st">"DF"</span>, <span class="st">"ES"</span>, </span>
<span>         <span class="st">"GO"</span>, <span class="st">"MA"</span>, <span class="st">"MT"</span>, <span class="st">"MS"</span>, <span class="st">"MG"</span>, <span class="st">"PA"</span>, <span class="st">"PB"</span>, <span class="st">"PR"</span>, <span class="st">"PE"</span>, </span>
<span>         <span class="st">"PI"</span>, <span class="st">"RJ"</span>, <span class="st">"RN"</span>, <span class="st">"RS"</span>, <span class="st">"RO"</span>, <span class="st">"RR"</span>, <span class="st">"SC"</span>, <span class="st">"SP"</span>, <span class="st">"SE"</span>, </span>
<span>         <span class="st">"TO"</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw">for</span><span class="op">(</span><span class="va">ano</span> <span class="kw">in</span> <span class="va">anos</span><span class="op">)</span><span class="op">{</span></span>
<span>  <span class="kw">for</span><span class="op">(</span><span class="va">mes</span> <span class="kw">in</span> <span class="va">meses</span><span class="op">)</span><span class="op">{</span></span>
<span>    <span class="kw">for</span><span class="op">(</span><span class="va">uf</span> <span class="kw">in</span> <span class="va">ufs</span><span class="op">)</span><span class="op">{</span></span>
<span>      <span class="co"># Baixa o dado para um ano, mês e UF específico</span></span>
<span>      <span class="va">tmp</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/fetch_datasus.html">fetch_datasus</a></span><span class="op">(</span></span>
<span>        year_start <span class="op">=</span> <span class="va">ano</span>, year_end <span class="op">=</span> <span class="va">ano</span>, </span>
<span>        month_start <span class="op">=</span> <span class="va">mes</span>, month_end <span class="op">=</span> <span class="va">mes</span>,</span>
<span>        uf <span class="op">=</span> <span class="va">uf</span>, information_system <span class="op">=</span> <span class="st">"SIH-RD"</span></span>
<span>      <span class="op">)</span></span>
<span>      </span>
<span>      <span class="co"># Pré-processamento dos dados</span></span>
<span>      <span class="va">tmp</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/process_sih.html">process_sih</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">tmp</span><span class="op">)</span></span>
<span>      </span>
<span>      <span class="co"># Escreve na tabela "sih" no banco de dados, </span></span>
<span>      <span class="co"># apensando os dados de cada ano e mês</span></span>
<span>      <span class="fu">dbWriteTable</span><span class="op">(</span>conn <span class="op">=</span> <span class="va">conn</span>, name <span class="op">=</span> <span class="st">"sih"</span>, value <span class="op">=</span> <span class="va">tmp</span>, append <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span>      </span>
<span>      <span class="co"># Remove a tabela temporária</span></span>
<span>      <span class="fu"><a href="https://rdrr.io/r/base/rm.html" class="external-link">rm</a></span><span class="op">(</span><span class="va">tmp</span><span class="op">)</span></span>
<span>    <span class="op">}</span></span>
<span>  <span class="op">}</span></span>
<span><span class="op">}</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="exemplo-de-consulta-ao-banco-de-dados">Exemplo de consulta ao banco de dados,<a class="anchor" aria-label="anchor" href="#exemplo-de-consulta-ao-banco-de-dados"></a>
</h3>
<p>Uma tabela de quantidade de registrosm, por sexo e causa básica</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/tbl.html" class="external-link">tbl</a></span><span class="op">(</span><span class="va">conn</span>, <span class="st">"sih"</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">group_by</a></span><span class="op">(</span><span class="va">SEXO</span>, <span class="va">COMPLEX</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html" class="external-link">summarise</a></span><span class="op">(</span>freq <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/context.html" class="external-link">n</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">ungroup</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/compute.html" class="external-link">collect</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Raphael Saldanha.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.9.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
